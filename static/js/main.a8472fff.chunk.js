(this.webpackJsonpreciclafono=this.webpackJsonpreciclafono||[]).push([[0],{40:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(19),s=a.n(r),o=a(18),i=a(3),l=a(2),u=a(6),j=a.n(u),d=a(13),p=a(10),b=a(1),h=c.a.createContext(),m=function(e){var t={OvaloLaFamilia:{name:"Ovalo la Familia",lat:-9.1282037,lng:-78.517,get latlng(){return[this.lat,this.lng]}},ViveroNuevoChimbote:{name:"Vivero de Nuevo Chimbote",lat:-9.1291256,lng:-78.5121042,get latlng(){return[this.lat,this.lng]}}},a=c.a.useState({points:[],loading:!1}),n=Object(p.a)(a,2),r=n[0],s=n[1],o=c.a.useState({distancia:0,ruta:[],rutaFormateada:[],loading:!1}),i=Object(p.a)(o,2),u=i[0],m=i[1],O=c.a.useState(!1),g=Object(p.a)(O,2),x=g[0],f=g[1],v=function(){var e=Object(d.a)(j.a.mark((function e(){var t,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s(Object(l.a)(Object(l.a)({},r),{},{loading:!0})),e.next=4,fetch("https://viajerotsp.herokuapp.com/puntos",{method:"GET",headers:{"Content-Type":"application/json"}});case 4:return t=e.sent,e.next=7,t.json();case 7:"No existe puntos registrados"!==(a=e.sent).message?s({points:a,loading:!1}):s(Object(l.a)(Object(l.a)({},r),{},{loading:!1})),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}(),N=function(){var e=Object(d.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://viajerotsp.herokuapp.com/eliminar/todo",{method:"DELETE",headers:{"Content-Type":"application/json"}});case 3:e.sent,s({points:[],loading:!1}),m({distancia:0,ruta:[],rutaFormateada:[],loading:!1}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),C=function(){var e=Object(d.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s(Object(l.a)(Object(l.a)({},r),{},{loading:!0})),e.next=4,fetch("https://viajerotsp.herokuapp.com/poblar-puntos",{method:"GET",headers:{"Content-Type":"application/json"}});case 4:e.sent,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),y=function(){var e=Object(d.a)(j.a.mark((function e(){var t,a,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,m(Object(l.a)(Object(l.a)({},u),{},{loading:!0})),e.next=4,fetch("https://viajerotsp.herokuapp.com/ruta",{method:"GET",headers:{"Content-Type":"application/json"}});case 4:return t=e.sent,e.next=7,t.json();case 7:a=e.sent,n=a.ruta.map((function(e){return[e.latitud,e.longitud]})),m({distancia:a.distancia,ruta:a.ruta,rutaFormateada:n,loading:!1}),f(!0),setTimeout((function(){return f(!1)}),4e3),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(0),m(Object(l.a)(Object(l.a)({},u),{},{loading:!1})),console.log(e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}();return Object(b.jsx)(h.Provider,{value:{stateOK:x,points:t,getCollectionPoints:v,stateCollectionPoints:r,getOptimalRoute:y,stateOptimalRoute:u,removeCollectionPoints:N,runExample:C},children:e.children})},O=c.a.createContext(),g=function(e){var t=c.a.useState({username:"Punto actual",lat:-9.1282037,lng:-78.517,get latlng(){return[this.lat,this.lng]},loading:!1}),a=Object(p.a)(t,2),n=a[0],r=a[1],s=c.a.useState(!1),o=Object(p.a)(s,2),i=o[0],u=o[1],h=function(){var e=Object(d.a)(j.a.mark((function e(t,a,c){var s,o;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r(Object(l.a)(Object(l.a)({},n),{},{loading:!0})),s={nombre:t,latitud:a,longitud:c},e.next=5,fetch("https://viajerotsp.herokuapp.com/punto",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});case 5:o=e.sent,r(Object(l.a)(Object(l.a)({},n),{},{username:t,lat:a,lng:c,loading:!1})),500!==o.status&&(u(!0),setTimeout((function(){return u(!1)}),4e3)),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),console.log("error"),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,a,n){return e.apply(this,arguments)}}();return Object(b.jsx)(O.Provider,{value:{stateUserOK:i,stateUserlocation:n,setStateUserLocation:r,getUserLocation:function(){navigator.geolocation?navigator.geolocation.getCurrentPosition((function(e){var t=e.coords.latitude,a=e.coords.longitude;r(Object(l.a)(Object(l.a)({},n),{},{lat:t,lng:a}))}),(function(e){console.log(e)}),{enableHighAccuracy:!0,maximumAge:0}):alert("Tecnolog\xeda de localizaci\xf3n no soportada por su navegador")},createUserLocation:h},children:e.children})},x=a(41),f=a(46),v=a(42),N=a(43),C=a(44),y=a(5),k=function(e){return new y.Icon({iconUrl:e,iconSize:[35,35]})},w=function(){var e=c.a.useContext(h).points,t=c.a.useContext(O),a=t.stateUserOK,n=t.stateUserlocation,r=t.setStateUserLocation,s=t.getUserLocation,o=t.createUserLocation;return Object(b.jsxs)("main",{className:"wrapper",children:[Object(b.jsx)("h1",{children:"Nuevo punto de recolecci\xf3n"}),Object(b.jsx)("p",{className:"subtitle",children:"Formulario para crear un nuevo punto de recolecci\xf3n de reciclaje"}),Object(b.jsxs)("form",{className:"form",autoComplete:"off",onSubmit:function(e){e.preventDefault();var t=e.target.username.value,a=/^(-?\d+\.)?-?\d+$/;t.trim()?a.test(n.lat)&&a.test(n.lng)?o(t,n.lat,n.lng):alert("Ingrese su ubicaci\xf3n correctamente !!"):alert("Ingrese su nombre correctamente !!")},children:[Object(b.jsx)("label",{htmlFor:"name",children:"Nombre:"}),Object(b.jsx)("input",{type:"text",id:"username",value:n.username,onChange:function(e){return r(Object(l.a)(Object(l.a)({},n),{},{username:e.target.value}))}}),Object(b.jsxs)("div",{className:"form-column",children:[Object(b.jsx)("p",{children:"Ubicaci\xf3n"}),Object(b.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:function(){s()},children:"Obtener ubicaci\xf3n"})]}),Object(b.jsx)("label",{htmlFor:"lat",children:"Lat: "}),Object(b.jsx)("input",{type:"text",id:"lat",value:n.lat,onChange:function(e){return r(Object(l.a)(Object(l.a)({},n),{},{lat:e.target.value}))},className:"readonly",readOnly:!0}),Object(b.jsx)("label",{htmlFor:"lng",children:"Lng: "}),Object(b.jsx)("input",{type:"text",id:"lng",value:n.lng,onChange:function(e){return r(Object(l.a)(Object(l.a)({},n),{},{lng:e.target.value}))},className:"readonly",readOnly:!0}),Object(b.jsx)("p",{children:"Mapa"}),Object(b.jsx)("div",{className:"map-default",children:Object(b.jsxs)(x.a,{center:e.OvaloLaFamilia.latlng,zoom:13,children:[Object(b.jsx)(f.a,{attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),n.lat&&n.lng&&Object(b.jsxs)(v.a,{position:[n.lat,n.lng],icon:k("./icons/marker.svg"),eventHandlers:{click:function(e){r(Object(l.a)(Object(l.a)({},n),{},{lat:e.latlng.lat,lng:e.latlng.lng}))}},draggable:!0,className:"marker",children:[Object(b.jsx)(N.a,{children:Object(b.jsx)("p",{children:n.username})}),Object(b.jsx)(C.a,{direction:"bottom",offset:[0,18],opacity:1,permanent:!0,className:"marker-tooltip",children:n.username})]})]})}),Object(b.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Crear punto"})]}),Object(b.jsxs)("div",{className:"alerts-container",children:[n.loading&&Object(b.jsx)("div",{className:"alert",children:Object(b.jsxs)("p",{children:[Object(b.jsx)("i",{className:"fas fa-spinner"})," Creando nuevo punto"]})}),a&&Object(b.jsx)("div",{className:"alert alert-ok",children:Object(b.jsxs)("p",{children:[Object(b.jsx)("i",{className:"far fa-check-circle"})," Creaci\xf3n correcta !!"]})})]})]})},F=a(45),L=function(e){return Object(b.jsxs)(v.a,{position:e.location,icon:e.icon,draggable:!1,className:"marker",children:[Object(b.jsx)(N.a,{children:Object(b.jsx)("p",{children:e.info})}),Object(b.jsx)(C.a,{direction:"bottom",offset:[0,18],opacity:1,permanent:!0,className:"marker-tooltip",children:e.info})]})},S=(a(34),function(){var e=c.a.useContext(h),t=e.stateOK,a=e.points,n=e.getCollectionPoints,r=e.stateCollectionPoints,s=e.getOptimalRoute,o=e.stateOptimalRoute,i=e.removeCollectionPoints,l=e.runExample;c.a.useEffect((function(){n(),s()}),[]);return Object(b.jsxs)("main",{className:"mapview-fullscreen",children:[Object(b.jsxs)(x.a,{center:a.ViveroNuevoChimbote.latlng,zoom:15,scrollWheelZoom:!1,children:[Object(b.jsx)(f.a,{attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),r.points.map((function(e,t){return Object(b.jsx)(L,{location:[e.latitud,e.longitud],info:e.nombre,icon:k("./icons/marker.svg")},t)})),Object(b.jsx)(F.a,{pathOptions:{color:"#ec3131"},positions:o.rutaFormateada})]}),Object(b.jsxs)("div",{className:"alerts-container",children:[o.loading&&Object(b.jsx)("div",{className:"alert",children:Object(b.jsxs)("p",{children:[Object(b.jsx)("i",{className:"fas fa-spinner"})," Cargando ruta optima"]})}),r.loading&&Object(b.jsx)("div",{className:"alert",children:Object(b.jsxs)("p",{children:[Object(b.jsx)("i",{className:"fas fa-spinner"})," Cargando marcadores"]})}),t&&Object(b.jsx)("div",{className:"alert alert-ok",children:Object(b.jsxs)("p",{children:[Object(b.jsx)("i",{className:"far fa-check-circle"})," Listo Ruta optima"]})})]}),Object(b.jsxs)("div",{className:"mapview-menu",children:[Object(b.jsx)("button",{onClick:function(){i()},className:"btn btn-secondary",children:"Eliminar todos los puntos"}),Object(b.jsx)("button",{onClick:function(){l()},className:"btn btn-secondary",children:"Ejecutar ejemplo"})]})]})}),T=function(){return Object(b.jsxs)("header",{className:"header",children:[Object(b.jsxs)("div",{className:"header-top",children:[Object(b.jsx)("h2",{children:"RECICLAFONO"}),Object(b.jsx)("button",{onClick:function(e){document.querySelector(".header-nav").classList.toggle("header-nav-active")},className:"btn header-btn-menu",children:Object(b.jsx)("i",{className:"fas fa-bars"})})]}),Object(b.jsx)("nav",{className:"header-nav",children:Object(b.jsxs)("ul",{children:[Object(b.jsx)("li",{children:Object(b.jsx)(o.b,{to:"/mapa",className:"header-option",activeClassName:"header-active",children:"Ver mapa"})}),Object(b.jsx)("li",{children:Object(b.jsx)(o.b,{to:"/",exact:!0,className:"header-option",activeClassName:"header-active",children:"+ Punto de Recolecci\xf3n"})})]})})]})};var P=function(){return Object(b.jsx)(o.a,{children:Object(b.jsxs)(i.c,{children:[Object(b.jsxs)(i.a,{path:"/mapa",children:[Object(b.jsx)(T,{}),Object(b.jsx)(S,{})]}),Object(b.jsxs)(i.a,{path:"/",children:[Object(b.jsx)(T,{}),Object(b.jsx)(w,{})]})]})})},E=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,47)).then((function(t){var a=t.getCLS,n=t.getFID,c=t.getFCP,r=t.getLCP,s=t.getTTFB;a(e),n(e),c(e),r(e),s(e)}))};s.a.render(Object(b.jsx)(c.a.StrictMode,{children:Object(b.jsx)(m,{children:Object(b.jsx)(g,{children:Object(b.jsx)(P,{})})})}),document.getElementById("root")),E()}},[[40,1,2]]]);
//# sourceMappingURL=main.a8472fff.chunk.js.map